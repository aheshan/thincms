!function(){var category_app=angular.module("category_app",[]);category_app.factory("CategoryService",function($http){return{getCategories:function(){var category_promiss=$http.get("api/category_api.php?action=get_all");return category_promiss},updateCategory:function(category){var category_promiss=$http.post("api/category_api.php?action=update",category);return category_promiss},saveCategory:function(category){var category_promiss=$http.post("api/category_api.php?action=save",category);return category_promiss},deleteCategory:function(category){var category_promiss=$http.post("api/category_api.php?action=delete",category);return category_promiss}}})}();
!function(category_app){var categoryCtrl;categoryCtrl=function($scope,CategoryService){var vm=this;vm.flash={isError:!1,isSuccess:!1,flashMessage:"Sample error message"},vm.category_model={cat_id:0,cat_name:"",cat_parent_id:0},vm.model_title="Add New Category",vm.flashErrorMessage=function(message){vm.flash.isError=!0,vm.flash.isSuccess=!1,vm.flash.flashMessage=message?message:"Error while performing operation."},vm.flashSucessMessage=function(message){vm.flash.isError=!1,vm.flash.isSuccess=!0,vm.flash.flashMessage=message},vm.hideFlash=function(){vm.flash.isError=!1,vm.flash.isSuccess=!1,vm.flash.flashMessage=""},vm.initCategories=function(){vm.categories=[],CategoryService.getCategories().then(function(payload){vm.categories=payload.data},function(){vm.flashErrorMessage("Error while featching categories")})},vm.addCategory=function(){vm.category_model.cat_id=0,vm.category_model.cat_name="",vm.category_model.cat_parent_id=0,vm.model_title="Add New Category"},vm.saveCategory=function(category_form){category_form.$valid&&CategoryService.saveCategory(vm.category_model).success(function(data){$("#myModal").modal("hide"),data.status?vm.flashSucessMessage(data.response_message):vm.flashErrorMessage(data.response_message),vm.initCategories()}).error(function(data){console.log("Error:"+data),vm.flashErrorMessage("Error while saving new category")})},vm.editCategory=function(category){vm.category_model.cat_id=category.category_id,vm.category_model.cat_name=category.category_name,vm.category_model.cat_parent_id=category.parent_id,vm.model_title="Update category '"+category.category_name+"'"},vm.updateCategory=function(category_form){category_form.$valid&&CategoryService.updateCategory(vm.category_model).success(function(data){$("#myModal").modal("hide"),data.status?vm.flashSucessMessage(data.response_message):vm.flashErrorMessage(data.response_message),vm.initCategories()}).error(function(data){console.log("Error:"+data),vm.flashErrorMessage("Error while saving new category")})},vm.deleteCategory=function(category){confirm("Are you sure to delete this category?")&&CategoryService.deleteCategory(category).success(function(data){data.status?vm.flashSucessMessage(data.response_message):vm.flashErrorMessage(data.response_message),vm.initCategories()}).error(function(data){console.log("Error:"+data),vm.flashErrorMessage("Error while deleting category")})}},categoryCtrl.$inject=["$scope","CategoryService"],category_app.controller("categoryCtrl",categoryCtrl)}(angular.module("category_app"));